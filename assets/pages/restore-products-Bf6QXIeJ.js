import"../modulepreload-polyfill-B5Qt9EMX.js";import"../injectNotificationCanvas-B7ZhukKg.js";import{i as g}from"../imageCarousel-Dy8HoRmN.js";import{q as u,i as p,r as y}from"../productApiHelper-BFk386Ij.js";import{s as i,b as h,d as B,c as E,e as P,a as c}from"../productGridRenderer-SpLrnwr9.js";import"../bootstrap.esm-C02OvDcj.js";import"../index-C0eOhpfv.js";import"../interceptor-CWYSvp79.js";import"../config-E-HGwCPq.js";const t={confirmDeleteModal:document.getElementById("confirmDeleteModal"),productModal:document.getElementById("productModal"),cancelDeleteBtn:document.getElementById("cancelDeleteBtn"),confirmDeleteBtn:document.getElementById("confirmDeleteBtn"),carouselImage:document.getElementById("carouselImage"),prevBtn:document.querySelector(".prev"),nextBtn:document.querySelector(".next"),modalProductName:document.getElementById("modalProductName"),modalDescription:document.getElementById("modalDescription"),modalPrice:document.getElementById("modalPrice"),modalCategory:document.getElementById("modalCategory"),modalMarkup:document.getElementById("modalMarkup"),modalMarkupPrice:document.getElementById("modalMarkupPrice"),restoreBtn:document.getElementById("deleteProductBtn"),closeModalBtn:document.querySelector(".close-modal"),qrCodeImage:document.querySelector(".qr-code"),productGrid:document.getElementById("productGrid"),pagination:document.getElementById("pagination"),searchInput:document.getElementById("searchInput"),categoryFilter:document.getElementById("categoryFilter"),sortSelect:document.getElementById("sortSelect")},I=async e=>{D(e._id),g({images:e.productImage}),t.modalProductName.textContent=e.name,t.modalDescription.textContent=e.description||"No description available.",t.modalPrice.textContent=e.price??"N/A",t.modalCategory.textContent=e.category??"Not categorized",t.modalMarkup.textContent=e.markup??"10",t.modalMarkupPrice.textContent=(e.price+e.price*(e.markup||10)/100).toFixed(2);const o=await u(e._id);t.qrCodeImage.src=URL.createObjectURL(o.data),t.productModal.classList.remove("hidden"),t.restoreBtn.onclick=()=>{t.confirmDeleteModal.classList.remove("hidden")}};t.closeModalBtn.addEventListener("click",()=>{t.productModal.classList.add("hidden")});const a={page:1,limit:12,totalPages:1,search:"",category:"",sort:""},v=()=>{C(),r()},r=async()=>{try{const e=await p({page:a.page,limit:a.limit,search:a.search,category:a.category,sort:a.sort}),{products:o,totalPages:s,currentPage:m}=e.data.data;if(a.totalPages=s,a.page=m,!o.length){i(),d(0);return}M(o),d(a.totalPages)}catch(e){console.error(e),h()}},M=e=>{E({container:t.productGrid,products:e,createCardHTML:P,onViewDetails:I,emptyState:i})},d=e=>{B({container:t.pagination,currentPage:a.page,totalPages:e,onPageChange:async o=>{a.page=o,await r()}})},C=()=>{t.searchInput.addEventListener("input",e=>{a.search=e.target.value.trim(),n()}),t.categoryFilter.addEventListener("change",e=>{a.category=e.target.value,n()}),t.sortSelect.addEventListener("change",e=>{a.sort=e.target.value,n()})},n=async()=>{a.page=1,await r()};let l=null;const L=()=>{t.cancelDeleteBtn.addEventListener("click",()=>{t.confirmDeleteModal.classList.add("hidden")}),t.confirmDeleteBtn.addEventListener("click",async()=>{try{const e=await y(l);c("success",e.data.message),t.confirmDeleteModal.classList.add("hidden"),t.productModal.classList.add("hidden"),await r()}catch(e){console.error(e),c("error","Failed to restore product")}}),window.addEventListener("click",e=>{const o=t.confirmDeleteModal;e.target===o&&o.classList.add("hidden")})},D=e=>{l=e};L();v();
