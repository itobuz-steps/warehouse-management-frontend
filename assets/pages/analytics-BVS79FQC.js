import"../modulepreload-polyfill-B5Qt9EMX.js";import"../injectNotificationCanvas-C6as7mfK.js";/* empty css                */import"../bootstrap.esm-C02OvDcj.js";import{a as d}from"../interceptor-D8J117qD.js";import{c as i}from"../config-D1K7ByuX.js";import{C as h,B as A,a as f,b as E,L as b,p as I,c as C,D as T,A as B,d as $,e as O,P as R}from"../chart-Q_aq-WEB.js";import"../index-C0eOhpfv.js";class U{warehouseOptions=t=>`<option class="dropdown-item warehouse-option" value="${t._id}" id="${t._id}">${t.name}</option>`;productOptions=t=>`<option class="dropdown-item product-option" value="${t.productId}" id="${t.productId}">${t.product.name}</option>`}const e={warehouseSelect:document.getElementById("warehouseSelect"),warehouseOptions:document.querySelectorAll(".warehouse-option"),productSelect1:document.getElementById("productSelect1"),productSelect2:document.getElementById("productSelect2"),productOptions:document.querySelectorAll(".product-option"),productSelectSection:document.querySelectorAll(".product-select"),analyticsForm:document.getElementById("analyticsForm"),analyticsSubmit:document.getElementById("analyticsSubmit"),noDataSection:document.getElementById("noDataFound"),chartGrid:document.getElementById("chartGrid"),lineChart:document.getElementById("lineChart"),barChart:document.getElementById("barChart"),transactionExcel:document.getElementById("transactionExcel"),quantityExcel:document.getElementById("quantityExcel")};h.register(A,f,E,b,I,C,T,B,$,O,R);let m=null,y=null;class x{analyticsTemplate=new U;loadOptions=async()=>{try{const o=(await d.get(`${i.WAREHOUSE_BASE_URL}/get-warehouses`)).data.data;o.forEach(l=>{e.warehouseSelect.innerHTML+=this.analyticsTemplate.warehouseOptions(l)});const r=o[0]._id,a=(await d.get(`${i.QUANTITY_BASE_URL}/warehouse-specific-products/${r}`)).data.data;a.length<=1&&e.noDataSection.classList.remove("d-none"),a.forEach(l=>{const p=this.analyticsTemplate.productOptions(l);e.productSelect1.innerHTML+=p,e.productSelect2.innerHTML+=p});const s=a[0].productId,n=a[0].productId,g=await d.get(`${i.PRODUCT_ANALYTICS_URL}/product-quantities?warehouseId=${r}&productA=${s}&productB=${n}`);await this.createBarChart(g.data.data);const S=await d.get(`${i.PRODUCT_ANALYTICS_URL}/product-comparison-history?warehouseId=${r}&productA=${s}&productB=${n}`);await this.createLineChart(S.data.data),e.warehouseSelect.addEventListener("change",l=>{const L=l.target.selectedOptions[0].id;this.loadProductOptions(L)})}catch(t){console.error("Error loading warehouse options:",t)}};loadProductOptions=async t=>{try{const o=await d.get(`${i.QUANTITY_BASE_URL}/warehouse-specific-products/${t}`);e.productSelect1.innerHTML="",e.productSelect2.innerHTML="",o.data.data.forEach(c=>{const a=this.analyticsTemplate.productOptions(c);e.productSelect1.innerHTML+=a,e.productSelect2.innerHTML+=a})}catch(o){console.error("Error loading product options:",o)}};getComparisonData=async t=>{try{t.preventDefault();const o=new FormData(t.target),r=o.get("warehouseSelect"),c=o.get("productSelect1"),a=o.get("productSelect2");e.noDataSection.style.display="none",e.chartGrid.style.display="grid";const s=await d.get(`${i.PRODUCT_ANALYTICS_URL}/product-quantities?warehouseId=${r}&productA=${c}&productB=${a}`);await this.createBarChart(s.data.data);const n=await d.get(`${i.PRODUCT_ANALYTICS_URL}/product-comparison-history?warehouseId=${r}&productA=${c}&productB=${a}`);await this.createLineChart(n.data.data)}catch(o){console.error(o)}};createBarChart=async t=>{const o=e.barChart;let r=new Array(t.productA.name,t.productB.name),c=new Array(t.productA.quantity,t.productB.quantity);m&&m.destroy(),m=new h(o,{type:"bar",data:{labels:r,datasets:[{data:c,backgroundColor:["#ff6384","#9966ff"]}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{x:{title:{display:!0,text:"Products",color:"#015453",font:{size:15}}},y:{title:{display:!0,text:"Quantity",color:"#015453",font:{size:15}},beginAtZero:!0}}}})};createLineChart=async t=>{const o=t.productA.history.map(a=>a.date),r=t.productA.history.map(a=>a.transactions),c=t.productB.history.map(a=>a.transactions);y&&y.destroy(),y=new h(e.lineChart,{type:"line",data:{labels:o,datasets:[{label:t.productA.name,data:r,borderWidth:2,fill:!1,borderColor:"#50af95",backgroundColor:"#50af95"},{label:t.productB.name,data:c,borderWidth:2,fill:!1,borderColor:"#FF6B6B",backgroundColor:"#FF6B6B"}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{title:{display:!0,text:"Last 7 Days (Daily)"}},scales:{x:{title:{display:!0,text:"Last 7 Days",color:"#015453",font:{size:15}}},y:{title:{display:!0,text:"Transactions",color:"#015453",font:{size:15}},ticks:{stepSize:1},beginAtZero:!0}}}})};getTwoProductQuantityExcel=async()=>{try{const t=e.warehouseSelect.value,o=e.productSelect1.value,r=e.productSelect2.value,c=await d.get(`${i.PRODUCT_ANALYTICS_URL}/get-two-products-quantity-chart-data?warehouseId=${t}&productA=${o}&productB=${r}`,{responseType:"blob"}),a=new Blob([c.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),s=window.URL.createObjectURL(a),n=document.createElement("a");n.href=s,n.download="two-products-quantity.xlsx",n.click(),window.URL.revokeObjectURL(s)}catch(t){console.error(t)}};getTwoProductTransactionExcel=async()=>{try{const t=e.warehouseSelect.value,o=e.productSelect1.value,r=e.productSelect2.value,c=await d.get(`${i.PRODUCT_ANALYTICS_URL}/get-two-products-transaction-chart-data?warehouseId=${t}&productA=${o}&productB=${r}`,{responseType:"blob"}),a=new Blob([c.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),s=window.URL.createObjectURL(a),n=document.createElement("a");n.href=s,n.download="two-products-transaction.xlsx",n.click(),window.URL.revokeObjectURL(s)}catch(t){console.error(t)}}}const u=new x;document.addEventListener("DOMContentLoaded",()=>{u.loadOptions()});e.analyticsForm.addEventListener("submit",u.getComparisonData);e.transactionExcel.addEventListener("click",u.getTwoProductTransactionExcel);e.quantityExcel.addEventListener("click",u.getTwoProductQuantityExcel);
